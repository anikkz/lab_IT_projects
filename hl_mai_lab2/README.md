# Лабораторные работы №1-2 #
Студентка: Никитина Анна

Группа: М8О-103М-20
## Установка необходимых компонентов ##
[Описана здесь](https://github.com/DVDemon/hl_mai_lab_01/blob/master/README.md)

## Сборка проекта ##
```bash
$ cmake --build CMakeFiles --target hl_mai_lab_01 -- -j 3 
```
## Подготовка перед запуском ##
Перед запуском необходимо создать БД и пользователя с доступом к ней. Для этого необходимо в директории `infrastructure/db_prepare` выполнить команды в файле `commands.sql` (Строки 1-15).
Также возможно заполнение БД сгенерированными данными в том же файле: строки 13,14.

## Запуск ##
```bash
$ docker-compose up -d
$ sudo sh ./start.sh
```
## Тестирование ##
Перед началом тестирования необходимо создать отдельную БД с копией всех оригинальных таблиц, для этого необходимо выполнить в директории `infrastructure/db_prepare` все комманды в файле `commands_test.sql`.

После чего необходимо собрать выполняемый файл для тестов, выполним следющую комманду:
```bash
$ cmake --build CMakeFiles --target gtests -- -j 3
```
Запус тестов запускается так:
```bash
$ ./CMakeFiles/gtests
```
## Нагрузочное тестирование ##
Нагрузочное тестирование осуществлялось с помощью утилиты wrk. 

```bash
$ wrk -t $Threads -c100 -d30s http://localhost:8080/person\?login\=166-06-8645
```

Кластер Apache Ignite из двух узлов и непосредственно приложение с БД были запущены на одной физической машине.  

В зависимости от числа потоков количество ответов в секуду и задержка менялись следующим образом:

**С использованием Apache Ignite**
Threads | Req/sec | Latency(ms)
--- | --- | ---
1 | 2107.20 | 6.91
2 | 1686.41 | 9.11
6 | 1728.89 | 9.15
10 | 1570.69 | 10.16

**Без использования Apache Ignite (ЛР №1)**
Threads | Req/sec | Latency(ms)
--- | --- | ---
1 | 275.05 | 57.55
2 | 267.08 | 59.73
6 | 254.59 | 85.23
10 | 256.86 | 128.93
